
#Mysql installation
sudo apt update
sudo apt install mysql-server
sudo mysql_secure_installation
ALTER USER 'root'@'127.0.0.1' IDENTIFIED WITH mysql_native_password BY 'T3553R4CT';

#Install node ------------------------------------------------------------------------------------------------
sudo apt-get install nodejs
sudo apt-get install npm    
npm i -g nodemon    
npm i -g yarn
npm i -g node-sass-chokidar 

#Setup nginx ------------------------------------------------------------------------------------------------
sudo apt-get install nginx
sudo ufw app list
sudo ufw allow 'Nginx Full'
sudo ufw allow 'OpenSSH'
sudo ufw enable
sudo systemctl start nginx
sudo systemctl enable nginx

#Status of nginx ------------------------------------------------------------------------------------------------
sudo systemctl status nginx

#Nginx code ------------------------------------------------------------------------------------------------
cd /etc/nginx/sites-enabled
nano default

#(paste the code below into the nano screen (file opened as default))
upstream node_js{
    server 127.0.1.1:3036;
}

server {
        listen 80;
        listen [::]:80;

        # SSL configuration
        #
        # listen 443 ssl default_server;
        # listen [::]:443 ssl default_server;
        #
        # Note: You should disable gzip for SSL traffic.
        # See: https://bugs.debian.org/773332
        #
        # Read up on ssl_ciphers to ensure a secure configuration.
        # See: https://bugs.debian.org/765782
        #
        # Self signed certs generated by the ssl-cert package
        # Don't use them in a production server!
        #
        # include snippets/snakeoil.conf;

        root /var/www/html;
        try_files $uri /index.html;

        access_log access.log;
        access_log on;
        location /api/ {
                # First attempt to serve request as file, then
                # as directory, then fall back to displaying a 404.
                proxy_pass http://node_js;
        }

}

#Build scripts for react ui app ------------------------------------------------------------------------------------------------
cd tesseract_ui
yarn build

#Run MySQL init scripts ------------------------------------------------------------------------------------------------
cd tesseract_service
sudo ./init.sh

#Run nodeJs service ------------------------------------------------------------------------------------------------
cd tesseract_service
screen 
nodemon index.js
